<html>

<head>
    <title>GlyphBox2d-Test</title>
    <script type="text/javascript" src="lib/path-utils.js"></script>
    <script type="text/javascript" src="lib/p5.js"></script>
    <script type="text/javascript">

    // one letter only
    var font, txt = "U", x = 200, y = 200, fontSize = 100;

    function preload()
    {
        font = loadFont("fonts/SourceSansPro.otf");
    }

    function setup()
    {
        createCanvas(600, 400);
        noLoop();
    }

    function draw()
    {
        background(240);
        noFill();
        stroke(0);

        var points = getPointsFromSimpleGlyph();
//console.log(points);
        var bbox = pathBounds(points);

        noFill();
        if (pointInBox(mouseX, mouseY, bbox))
            fill(200,0,0,64);

        //rect(bbox.x, bbox.y, bbox.w, bbox.h);

        fill(255);
        if (pointInPoly(mouseX, mouseY, points))
            fill(200,0,0);

        drawSimpleGlyph(points);
    }

    function getPointsFromSimpleGlyph() { // one letter, one path

        var glyph = font._getGlyphs(txt)[0];
        var gpath = glyph.getPath(x, y, fontSize);
        var pathPts = parsePathPoints(gpath.commmands);
        var path = splitPaths(gpath.toPathData())[0];
        return pointsFromPath(path, {
            //removeCollinears: .2
            sampleFactor: .2
        });
    }

    function drawSimpleGlyph(points) {

        beginShape();
        for (var i = 0; i < pathPts.length; i++) {
            ellipse(pathPts[i].x, pathPts[i].y,4,4);
        }
        for (var i = 0; i < points.length; i++) {
            vertex(points[i].x, points[i].y);
            ellipse(points[i].x, points[i].y,4,4);
        }
        endShape(CLOSE);
    }

</script>
</head>
<div id="drawing"></div>


</html>
