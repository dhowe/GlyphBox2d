<html>

<head>
    <title>PolyInPolyTest</title>
    <script type="text/javascript" src="lib/path-utils.js"></script>
    <script type="text/javascript" src="lib/p5.js"></script>
    <script type="text/javascript">

    var font, txt = "%", x = 200, y = 200, fontSize = 100;

    function preload()
    {
        font = loadFont("fonts/SourceSansPro.otf");
    }

    function setup()
    {
        createCanvas(600, 400);
        noLoop();
    }

    function draw()
    {
        background(240);
        noFill();
        stroke(0);
        drawGlyph();
    }

    function drawGlyph() {

        var glyph = font._getGlyphs(txt)[0],
            gpath = glyph.getPath(x, y, fontSize),
            paths = splitPaths(gpath.toPathData()),
            pathPts = [];

        for (var j = 0; j < paths.length; j++) {

            var pts = pointsFromPath(paths[j]);
            pathPts.push(pts);

            if (j > 0) {
                noFill();

                for (var i = j-1; i >= 0; i--) {
                    console.log(j+' checking '+i);
                    if (polyInPoly(pathPts[i], pathPts[j])) {
                        console.log('HIT!');
                        fill(200,0,0);
                    }
                }
            }

            beginShape();
            for (var i = 0; i < pts.length; i++)
                vertex(pts[i].x, pts[i].y);
            endShape(CLOSE);
        }


    }

    function drawPoints(pts)
    {
        for (var i = 0; i < pts.length; i++)
            ellipse(pts[i].x, pts[i].y, 2, 2);
    }

</script>
</head>
<div id="drawing"></div>


</html>
